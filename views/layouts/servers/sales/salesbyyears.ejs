<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Thống kê</title>
    <%- include('../partials/head') %>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@^3"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@^2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment@^1"></script>
  </head>
  <body>
    <!--sidebar start-->
    <%- include('../partials/sidebar') %>
    <!-- sidebar end -->

    <!--main content start-->
    <section id="main-content">
      <section class="wrapper">
        <div class="table-agile-info">
          <h3>
            Doanh thu năm 2023
          </h3>
          <p id="monthlyData" style="display: none;"><%= monthlyData %></p>
          <div class="chartCard">
            <div class="chartBox">
              <canvas id="myChart"></canvas>
              <div>
                <h3>Tháng</h3>
              </div>
              <% for (var i = 0; i < 12; i++){ %>
              <a href="/monthlySale/<%= i %>"><button class="btn btn-primary">Tháng <%= i+1 %></button></a>
              <% } %>
              <!-- <a href="/tuesday"><button class="btn btn-primary">Thứ 3</button></a>
              <a href="/wednesday"><button class="btn btn-primary">Thứ 4</button></a>
              <a href="/thursday"><button class="btn btn-primary">Thứ 5</button></a>
              <a href="/friday"><button class="btn btn-primary">Thứ 6</button></a>
              <a href="/saturday"><button class="btn btn-primary">Thứ 7</button></a>
              <a href="/sunday"><button class="btn btn-primary">Chủ nhật</button></a> -->
            </div>
          </div>
        </div>
      </section>
    </section>
    <script>
      const value = document.getElementById("monthlyData").innerHTML;
      const monthlyData = value.split(",");
      const [var1, var2, var3, var4, var5, var6, var7, var8, var9, var10, var11, var12] = monthlyData;

      var startOfYear = moment().month(0);
      var endOfYear = moment().month(11);
      var months = [];
      var month = startOfYear;

      while (month <= endOfYear) {
        months.push(month.format("YYYY-MM"));
        month = month.clone().add(1, "M");
      }
      const data = {
        labels: months,
        datasets: [
          {
            label: "Doanh thu",
            data: [var1, var2, var3, var4, var5, var6, var7, var8, var9, var10, var11, var12],
            backgroundColor: "rgba(76, 175, 80, 1)",
            borderColor: "rgba(0,0,0)",
            borderWidth: 1,
          },
        ],
      };
      // config
      const config = {
        type: "bar",
        data,
        options: {
          scales: {
            x: {
              type: "time",
              time: {
                unit: "month",
                displayFormats: {
                  month: "M"
                }
              },
            },
            y: {
              beginAtZero: true,
            },
          },
        },
      };
      // render init block
      const myChart = new Chart(document.getElementById("myChart"), config);
      // Instantly assign Chart.js version
      const chartVersion = document.getElementById("chartVersion");
      chartVersion.innerText = Chart.version;
  </script>
    <!--main content end-->
    <%- include('../partials/footer') %>
  </body>

  <!-- Filter date -->
</html>
