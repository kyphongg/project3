<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Giỏ hàng</title>
    <%- include('partials/head') %>
  </head>
  <body>
    <%- include('partials/header') %>

    <div class="container">
      <div class="cartt">
        <div class="cart-heading">
          <img
            style="margin-top: 25px; margin-right: 10px; width: 25px; height: 25px;" src="/images/carttt.png" alt="" />
          <h3 style="margin-top: 18px;">Giỏ hàng</h3>
        </div>
        <%if(!carti[0]){%>
          <p>Trống</p>
        <%}else{%>
          <div class="cart-table">
            <div id="leftbox">
              <table class="table table-bordered table-striped">
                <thead>
                  <tr>
                      <th>Hình ảnh</th>
                      <th>Tên sản phẩm</th>
                      <th style="border-right:none;">Đơn giá</th>
                  </tr>
                </thead>
                <tbody>
                  <% for(let i=0; i < danhsach.length; i++) { %> <%
                  danhsach[i].items.forEach(function(pid) { %>
                    <td style="width: 155px;">
                      <img
                        style="width: 60px; height: 80px;"
                        src="/images/<%= pid.productID.productImage %>"
                        alt=""
                      />
                    </td>
                    <td style="width: 320px;">
                      <a href="/product/<%= pid.productID._id %>" style="text-decoration: none; color: #000;"><p style="line-height: 5px"><%= pid.productID.productName %></p></a>
                    </td>
                    <td style="width: 125px">
                      <p style="color: #dc4e45"><%= VND.format(pid.productID.priceOut) %> </p>
                    </td>
                  </tr>
                  <% }); %> <% } %>
                </tbody>
              </table>
            </div>
  
            <div id="rightbox">
              <table class="table table-bordered table-striped">
                  <thead>
                      <tr>
                          <th>Số lượng</th>
                          <th>Thành tiền</th>
                          <th>Hành động</th>
                      </tr>
                  </thead>
  
                <tbody>
                  <% for(let i=0; i < danhsach.length; i++) { %> <%
                  danhsach[i].items.forEach(function(id) { %>
                  <tr>
                    <td style="width: 225px; height: 96.75px;">
                      <form>
                          <input name="product_id_hidden" type="hidden" value="<%= id._id %>"/>
                          <input name="user_id_hidden" type="hidden" value="<%= userid %>"/>
                          <input type="number" min="1" max="" value="<%= id.quantity %>" name="quantity" style="width: 45px; height: 30px; padding-left: 10px"/>
                          <input type="submit" value="Cập nhật" name="update_quantity" class="btn btn-primary update-quantity" style="margin-bottom: 5px; margin-left: 5px"/>
                      </form>
                    </td>
                    <td style="width: 125px;">
                      <p style="color: #dc4e45"><%= VND.format(id.productID.priceOut * id.quantity) %></p>
                    </td>
                    <td style="width: 200px;">
                      <a onclick="return confirm('Xoá ?')" href="/delete_cart_items/<%= id._id %>" style="text-decoration: none;;" class="btn btn-danger"><i class="fa-regular fa-trash-can" style="color: white;"></i> Xóa sản phẩm</a>
                    </td>
                  </tr>
                  <% }); %> <% } %>
                </tbody>
              </table>
            </div>
          </div>
          <div class="row">
            <div class="col-8"></div>
            <div class="col-4">
                <div class="cart-price">
                    <div class="pay">
                    <a href="/">
                        <button class="btn btn-secondary btn-pay">THANH TOÁN</button>
                    </a>
                    </div>
                    <div class="back-home">
                        <a href="/">
                            <button class="btn btn-outline-dark btn-back-home">TIẾP TỤC MUA HÀNG</button>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <%}%>
        
        
      </div>
    </div>

    <%- include('partials/footer') %>
  </body>
</html>
